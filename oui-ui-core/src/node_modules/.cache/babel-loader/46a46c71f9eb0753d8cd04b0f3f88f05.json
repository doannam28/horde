{"remainingRequest":"D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\node_modules\\babel-loader\\lib\\index.js!D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\src\\router.js","dependencies":[{"path":"D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\src\\router.js","mtime":1591674512000},{"path":"D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import Vue from 'vue';\nimport Router from 'vue-router';\nimport { session } from \"./plugins/session\";\nimport { ubus } from \"./plugins/ubus\";\nimport store from \"./store\";\nimport i18n from \"./i18n\";\nVue.use(Router);\nvar router = new Router({\n  routes: [{\n    path: '/login',\n    component: function component() {\n      return import('@/views/login.vue');\n    }\n  }, {\n    path: '/',\n    redirect: '/home',\n    component: function component() {\n      return import('@/components/layout');\n    },\n    children: [{\n      path: 'home',\n      component: function component() {\n        return import('@/views/home.vue');\n      },\n      meta: {\n        title: 'Home'\n      }\n    }]\n  }, {\n    path: '*',\n    component: function component() {\n      return import('@/components/404.vue');\n    }\n  }]\n});\n\nfunction beforeEach(to, next, alive) {\n  if (to.path !== '/login') {\n    if (alive) {\n      if (!session.aclCache) {\n        session.updateACLs().then(function () {\n          next();\n        });\n      } else {\n        next();\n      }\n    } else {\n      next('/login');\n    }\n  } else {\n    next();\n  }\n}\n\nrouter.beforeEach(function (to, from, next) {\n  session.isAlive().then(function (alive) {\n    if (alive) session.startHeartbeat();else session.logout();\n\n    if (!store.state.lang) {\n      ubus.call('oui.ui', 'lang').then(function (_ref) {\n        var lang = _ref.lang;\n        store.commit('setLang', lang);\n        if (lang === 'auto') lang = navigator.language;\n        i18n.locale = lang;\n        beforeEach(to, next, alive);\n      });\n    } else {\n      beforeEach(to, next, alive);\n    }\n  });\n});\nrouter.onError(function (err) {\n  if (err.code !== 'MODULE_NOT_FOUND') throw err;\n  router.push('/404');\n});\nexport default router;",{"version":3,"sources":["D:\\Project VMODEV\\Horde\\oui\\oui-master\\oui-ui-core\\src\\src\\router.js"],"names":["Vue","Router","session","ubus","store","i18n","use","router","routes","path","component","redirect","children","meta","title","beforeEach","to","next","alive","aclCache","updateACLs","then","from","isAlive","startHeartbeat","logout","state","lang","call","commit","navigator","language","locale","onError","err","code","push"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,MAAP,MAAmB,YAAnB;AACA,SAAQC,OAAR;AACA,SAAQC,IAAR;AACA,OAAOC,KAAP;AACA,OAAOC,IAAP;AAEAL,GAAG,CAACM,GAAJ,CAAQL,MAAR;AAEA,IAAMM,MAAM,GAAG,IAAIN,MAAJ,CAAW;AACxBO,EAAAA,MAAM,EAAE,CACN;AACEC,IAAAA,IAAI,EAAE,QADR;AAEEC,IAAAA,SAAS,EAAE;AAAA,aAAM,OAAO,mBAAP,CAAN;AAAA;AAFb,GADM,EAKN;AACED,IAAAA,IAAI,EAAE,GADR;AAEEE,IAAAA,QAAQ,EAAE,OAFZ;AAGED,IAAAA,SAAS,EAAE;AAAA,aAAM,OAAO,qBAAP,CAAN;AAAA,KAHb;AAIEE,IAAAA,QAAQ,EAAE,CACR;AACEH,MAAAA,IAAI,EAAE,MADR;AAEEC,MAAAA,SAAS,EAAE;AAAA,eAAM,OAAO,kBAAP,CAAN;AAAA,OAFb;AAGEG,MAAAA,IAAI,EAAG;AACLC,QAAAA,KAAK,EAAE;AADF;AAHT,KADQ;AAJZ,GALM,EAmBN;AACEL,IAAAA,IAAI,EAAE,GADR;AAEEC,IAAAA,SAAS,EAAE;AAAA,aAAM,OAAO,sBAAP,CAAN;AAAA;AAFb,GAnBM;AADgB,CAAX,CAAf;;AA2BA,SAASK,UAAT,CAAoBC,EAApB,EAAwBC,IAAxB,EAA8BC,KAA9B,EAAqC;AACnC,MAAIF,EAAE,CAACP,IAAH,KAAY,QAAhB,EAA0B;AACxB,QAAIS,KAAJ,EAAW;AACT,UAAI,CAAChB,OAAO,CAACiB,QAAb,EAAuB;AACrBjB,QAAAA,OAAO,CAACkB,UAAR,GAAqBC,IAArB,CAA0B,YAAM;AAC9BJ,UAAAA,IAAI;AACL,SAFD;AAGD,OAJD,MAIO;AACLA,QAAAA,IAAI;AACL;AACF,KARD,MAQO;AACLA,MAAAA,IAAI,CAAC,QAAD,CAAJ;AACD;AACF,GAZD,MAYO;AACLA,IAAAA,IAAI;AACL;AACF;;AAEDV,MAAM,CAACQ,UAAP,CAAkB,UAACC,EAAD,EAAKM,IAAL,EAAWL,IAAX,EAAoB;AACpCf,EAAAA,OAAO,CAACqB,OAAR,GAAkBF,IAAlB,CAAuB,UAAAH,KAAK,EAAI;AAC9B,QAAIA,KAAJ,EACEhB,OAAO,CAACsB,cAAR,GADF,KAGEtB,OAAO,CAACuB,MAAR;;AAEF,QAAI,CAACrB,KAAK,CAACsB,KAAN,CAAYC,IAAjB,EAAuB;AACrBxB,MAAAA,IAAI,CAACyB,IAAL,CAAU,QAAV,EAAoB,MAApB,EAA4BP,IAA5B,CAAiC,gBAAY;AAAA,YAAVM,IAAU,QAAVA,IAAU;AAC3CvB,QAAAA,KAAK,CAACyB,MAAN,CAAa,SAAb,EAAwBF,IAAxB;AACA,YAAIA,IAAI,KAAK,MAAb,EACEA,IAAI,GAAGG,SAAS,CAACC,QAAjB;AACF1B,QAAAA,IAAI,CAAC2B,MAAL,GAAcL,IAAd;AAEAZ,QAAAA,UAAU,CAACC,EAAD,EAAKC,IAAL,EAAWC,KAAX,CAAV;AACD,OAPD;AAQD,KATD,MASO;AACLH,MAAAA,UAAU,CAACC,EAAD,EAAKC,IAAL,EAAWC,KAAX,CAAV;AACD;AACF,GAlBD;AAmBD,CApBD;AAsBAX,MAAM,CAAC0B,OAAP,CAAe,UAAAC,GAAG,EAAI;AACpB,MAAIA,GAAG,CAACC,IAAJ,KAAa,kBAAjB,EACE,MAAMD,GAAN;AACF3B,EAAAA,MAAM,CAAC6B,IAAP,CAAY,MAAZ;AACD,CAJD;AAMA,eAAe7B,MAAf","sourcesContent":["import Vue from 'vue'\nimport Router from 'vue-router'\nimport {session} from './plugins/session'\nimport {ubus} from './plugins/ubus'\nimport store from './store'\nimport i18n from './i18n'\n\nVue.use(Router)\n\nconst router = new Router({\n  routes: [\n    {\n      path: '/login',\n      component: () => import('@/views/login.vue')\n    },\n    {\n      path: '/',\n      redirect: '/home',\n      component: () => import('@/components/layout'),\n      children: [\n        {\n          path: 'home',\n          component: () => import('@/views/home.vue'),\n          meta:  {\n            title: 'Home'\n          }\n        }\n      ]\n    },\n    {\n      path: '*',\n      component: () => import('@/components/404.vue')\n    }\n  ]\n})\n\nfunction beforeEach(to, next, alive) {\n  if (to.path !== '/login') {\n    if (alive) {\n      if (!session.aclCache) {\n        session.updateACLs().then(() => {\n          next();\n        });\n      } else {\n        next();\n      }\n    } else {\n      next('/login');\n    }\n  } else {\n    next();\n  }\n}\n\nrouter.beforeEach((to, from, next) => {\n  session.isAlive().then(alive => {\n    if (alive)\n      session.startHeartbeat();\n    else\n      session.logout();\n\n    if (!store.state.lang) {\n      ubus.call('oui.ui', 'lang').then(({lang}) => {\n        store.commit('setLang', lang);\n        if (lang === 'auto')\n          lang = navigator.language;\n        i18n.locale = lang;\n\n        beforeEach(to, next, alive);\n      });\n    } else {\n      beforeEach(to, next, alive);\n    }\n  });\n});\n\nrouter.onError(err => {\n  if (err.code !== 'MODULE_NOT_FOUND')\n    throw err\n  router.push('/404');\n});\n\nexport default router\n"]}]}