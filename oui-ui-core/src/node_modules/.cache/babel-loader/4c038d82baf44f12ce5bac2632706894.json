{"remainingRequest":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\babel-loader\\lib\\index.js!D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\src\\components\\uci-form\\src\\filebrowser.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\src\\components\\uci-form\\src\\filebrowser.vue","mtime":1591674512000},{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      location: '/',\n      selected: '',\n      files: [],\n      newType: '',\n      newFileName: ''\n    };\n  },\n  methods: {\n    readdir: function readdir(file) {\n      var _this = this;\n\n      if (file === '..') {\n        if (this.location === '/') return;\n        var paths = this.location.spli('/');\n        this.location = paths.slice(0, paths.length - 2).join('/') + '/';\n      } else {\n        if (!file.dir) {\n          this.selected = file.path;\n          this.$emit('selected', this.selected);\n          return;\n        }\n\n        this.location = file.path + '/';\n      }\n\n      this.$ubus.call('oui.system', 'read_dir', {\n        path: this.location\n      }).then(function (r) {\n        _this.files = r.files;\n      });\n    },\n    showInput: function showInput(cmd) {\n      var _this2 = this;\n\n      if (cmd === 'newfile') {\n        this.newType = 'file';\n      } else {\n        this.newType = 'folder';\n      }\n\n      this.$nextTick(function () {\n        _this2.$refs['input'].focus();\n      });\n    },\n    newFile: function newFile() {\n      var _this3 = this;\n\n      var name = this.newFileName;\n      var isDir = this.newType === 'folder';\n      this.newFileName = '';\n      this.newType = '';\n\n      if (name) {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = this.files[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var file = _step.value;\n\n            if (file.name === name) {\n              this.$message.warning('Already exists');\n              return;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n\n        var path = this.location + name;\n        this.$ubus.call('oui.system', 'new_file', {\n          path: path,\n          dir: isDir\n        }).then(function (r) {\n          if (r.r === 0) {\n            _this3.files.push({\n              name: name,\n              dir: isDir,\n              path: path\n            });\n\n            if (!isDir) {\n              _this3.selected = path;\n\n              _this3.$emit('selected', _this3.selected);\n            }\n          }\n        });\n      }\n    }\n  },\n  created: function created() {\n    var _this4 = this;\n\n    this.$ubus.call('oui.system', 'read_dir').then(function (r) {\n      _this4.files = r.files;\n    });\n  }\n};",{"version":3,"sources":["filebrowser.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <el-row>\n      <el-col :span=\"18\">{{ location }}</el-col>\n      <el-col :span=\"6\">\n        <el-dropdown size=\"small\" @command=\"showInput\">\n          <el-button type=\"primary\" size=\"small\">{{ ('New') }}<i class=\"el-icon-arrow-down el-icon--right\"></i></el-button>\n          <el-dropdown-menu slot=\"dropdown\">\n              <el-dropdown-item command=\"newfile\"><img style=\"vertical-align: text-bottom; margin-right: 2px\" src=\"/icons/file.png\" />{{ ('File') }}</el-dropdown-item>\n              <el-dropdown-item command=\"newfolder\"><img style=\"vertical-align: text-bottom; margin-right: 2px\" src=\"/icons/folder.png\" />{{ ('Folder') }}</el-dropdown-item>\n          </el-dropdown-menu>\n        </el-dropdown>\n      </el-col>\n    </el-row>\n    <ul style=\"padding-left: 0; list-style-type: none\" class=\"oui-filebrowser\">\n      <li @click=\"readdir('..')\" style=\"cursor: pointer\">\n        <img style=\"vertical-align: bottom; margin-right: 2px\" src=\"/icons/parent-folder.png\" />\n        <span>..</span>\n      </li>\n      <li v-for=\"f in files\" :key=\"f.name\" @click=\"readdir(f)\" style=\"cursor: pointer\" :class=\"{selected: selected === f.path}\">\n        <img style=\"vertical-align: bottom; margin-right: 2px\" :src=\"f.dir ? '/icons/folder.png' : '/icons/file.png'\" />\n        <span>{{ f.name }}</span>\n      </li>\n      <li v-if=\"newType\">\n        <img style=\"vertical-align: bottom; margin-right: 2px\" :src=\"(newType === 'file') ? '/icons/file.png' : '/icons/folder.png'\" />\n        <input ref=\"input\" v-model=\"newFileName\" @keyup.enter=\"newFile\" @blur=\"newFile\" />\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      location: '/',\n      selected: '',\n      files: [],\n      newType: '',\n      newFileName: ''\n    }\n  },\n  methods: {\n    readdir(file) {\n      if (file === '..') {\n        if (this.location === '/')\n          return;\n        let paths = this.location.spli('/');\n        this.location = paths.slice(0, paths.length - 2).join('/') + '/';\n      } else {\n        if (!file.dir) {\n          this.selected = file.path;\n          this.$emit('selected', this.selected);\n          return;\n        }\n        this.location = file.path + '/';\n      }\n\n      this.$ubus.call('oui.system', 'read_dir', {path: this.location}).then(r => {\n        this.files = r.files;\n      });\n    },\n    showInput(cmd) {\n      if (cmd === 'newfile') {\n        this.newType = 'file';\n      } else {\n        this.newType = 'folder';\n      }\n\n      this.$nextTick(() => {\n        this.$refs['input'].focus();\n      });\n    },\n    newFile() {\n      const name = this.newFileName;\n      const isDir = this.newType === 'folder';\n\n      this.newFileName = '';\n      this.newType = '';\n\n      if (name) {\n        for (let file of this.files) {\n          if (file.name === name) {\n            this.$message.warning(('Already exists'));\n            return;\n          }\n        }\n\n        const path = this.location + name;\n\n        this.$ubus.call('oui.system', 'new_file', {path: path, dir: isDir}).then(r => {\n          if (r.r === 0) {\n            this.files.push({\n              name: name,\n              dir: isDir,\n              path: path\n            });\n\n            if (!isDir) {\n              this.selected = path;\n              this.$emit('selected', this.selected);\n            }\n          }\n        });\n      }\n    }\n  },\n  created() {\n    this.$ubus.call('oui.system', 'read_dir').then(r => {\n      this.files = r.files;\n    });\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.oui-filebrowser {\n  li:hover {\n    background-color: #CCE8FF80;\n  }\n\n  .selected {\n    background-color: #CCE8FF;\n  }\n}\n</style>\n"],"sourceRoot":"src/components/uci-form/src"}]}