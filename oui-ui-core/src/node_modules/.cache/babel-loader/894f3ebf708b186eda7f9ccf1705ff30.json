{"remainingRequest":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\babel-loader\\lib\\index.js!D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\src\\plugins\\firewall.js","dependencies":[{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\src\\plugins\\firewall.js","mtime":1591674512000},{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _classCallCheck from \"D:\\\\Project VMODEV\\\\Horde\\\\horde-oui\\\\oui-ui-core\\\\src\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\Project VMODEV\\\\Horde\\\\horde-oui\\\\oui-ui-core\\\\src\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport { uci } from \"./uci\";\nvar firewall = {\n  zones: [],\n  forwards: []\n};\n\nvar Zone =\n/*#__PURE__*/\nfunction () {\n  function Zone(sid) {\n    _classCallCheck(this, Zone);\n\n    this.sid = sid;\n  }\n\n  _createClass(Zone, [{\n    key: \"get\",\n    value: function get(key) {\n      return uci.get('firewall', this.sid, key);\n    }\n  }, {\n    key: \"set\",\n    value: function set(key, val) {\n      return uci.set('firewall', this.sid, key, val);\n    }\n  }, {\n    key: \"name\",\n    value: function name() {\n      return this.get('name');\n    }\n  }, {\n    key: \"network\",\n    value: function network() {\n      var nets = this.get('network') || [];\n      if (!Array.isArray(nets)) nets = nets.split(' ');\n      return nets;\n    }\n  }, {\n    key: \"addNetwork\",\n    value: function addNetwork(net) {\n      var nets = this.network();\n      if (nets.indexOf(net) > -1) return;\n      nets.push(net);\n      this.set('network', nets.join(' '));\n    }\n  }, {\n    key: \"delNetwork\",\n    value: function delNetwork(net) {\n      var nets = this.network();\n      if (nets.indexOf(net) < 0) return;\n      nets.splice(nets.indexOf(net), 1);\n      this.set('network', nets.join(' '));\n    }\n  }, {\n    key: \"findForwardsBy\",\n    value: function findForwardsBy(what) {\n      var forwards = [];\n      var name = this.name();\n      if (what !== 'src' && what !== 'dest') return forwards;\n      firewall.forwards.forEach(function (fwd) {\n        if (fwd.src() && fwd.dest() && fwd[what]() === name) forwards.push(fwd);\n      });\n      return forwards;\n    }\n  }, {\n    key: \"color\",\n    value: function color() {\n      var name = this.name();\n      if (name === 'lan') return '#90f090';else if (name === 'wan') return '#f09090';\n      var r = parseInt(Math.random() * 128) + 1;\n      var g = parseInt(Math.random() * 128) + 1;\n      var min = 0;\n      var max = 128;\n      if (r + g < 128) min = 128 - r - g;else max = 255 - r - g;\n      var b = min + Math.floor(Math.random() * (max - min));\n      return '#%02x%02x%02x'.format(0xFF - r, 0xFF - g, 0xFF - b);\n    }\n  }]);\n\n  return Zone;\n}();\n\nvar Forward =\n/*#__PURE__*/\nfunction () {\n  function Forward(sid) {\n    _classCallCheck(this, Forward);\n\n    this.sid = sid;\n  }\n\n  _createClass(Forward, [{\n    key: \"get\",\n    value: function get(key) {\n      return uci.get('firewall', this.sid, key);\n    }\n  }, {\n    key: \"set\",\n    value: function set(key, val) {\n      return uci.set('firewall', this.sid, key, val);\n    }\n  }, {\n    key: \"src\",\n    value: function src() {\n      return this.get('src');\n    }\n  }, {\n    key: \"dest\",\n    value: function dest() {\n      return this.get('dest');\n    }\n  }]);\n\n  return Forward;\n}();\n\nfirewall.loadFromLocal = function () {\n  this.zones = uci.sections('firewall', 'zone').map(function (s) {\n    return new Zone(s['.name']);\n  });\n  this.forwards = uci.sections('firewall', 'forwarding').map(function (s) {\n    return new Forward(s['.name']);\n  });\n};\n\nfirewall.load = function (local) {\n  var _this = this;\n\n  if (local) {\n    this.loadFromLocal();\n    return;\n  }\n\n  return new Promise(function (resolve) {\n    uci.load('firewall').then(function () {\n      _this.loadFromLocal();\n\n      resolve();\n    });\n  });\n};\n\nfirewall.findZoneByNetwork = function (net) {\n  for (var i = 0; i < this.zones.length; i++) {\n    var zone = this.zones[i];\n    var nets = zone.network();\n    if (nets.indexOf(net) > -1) return zone;\n  }\n\n  return undefined;\n};\n\nfirewall.findZoneByName = function (name) {\n  for (var i = 0; i < this.zones.length; i++) {\n    var zone = this.zones[i];\n    if (zone.name() === name) return zone;\n  }\n\n  return undefined;\n};\n\nfirewall.findZoneBySid = function (sid) {\n  for (var i = 0; i < this.zones.length; i++) {\n    var zone = this.zones[i];\n    if (zone.sid === sid) return zone;\n  }\n\n  return undefined;\n};\n\nfirewall.createZone = function (name) {\n  var sid = uci.add('firewall', 'zone');\n  var z = new Zone(sid);\n  this.zones.push(z);\n  z.set('name', name);\n  z.set('input', 'ACCEPT');\n  z.set('forward', 'REJECT');\n  z.set('output', 'ACCEPT');\n  return z;\n};\n\nexport default {\n  install: function install(Vue) {\n    Vue.prototype.$firewall = firewall;\n  }\n};",{"version":3,"sources":["D:\\Project VMODEV\\Horde\\horde-oui\\oui-ui-core\\src\\src\\plugins\\firewall.js"],"names":["uci","firewall","zones","forwards","Zone","sid","key","get","val","set","nets","Array","isArray","split","net","network","indexOf","push","join","splice","what","name","forEach","fwd","src","dest","r","parseInt","Math","random","g","min","max","b","floor","format","Forward","loadFromLocal","sections","map","s","load","local","Promise","resolve","then","findZoneByNetwork","i","length","zone","undefined","findZoneByName","findZoneBySid","createZone","add","z","install","Vue","prototype","$firewall"],"mappings":"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","sourcesContent":["import {uci} from './uci'\n\nconst firewall = {\n  zones: [],\n  forwards: []\n}\n\nclass Zone {\n  constructor(sid) {\n    this.sid = sid;\n  }\n\n  get(key) {\n    return uci.get('firewall', this.sid, key);\n  }\n\n  set(key, val) {\n    return uci.set('firewall', this.sid, key, val);\n  }\n\n  name() {\n    return this.get('name');\n  }\n\n  network() {\n    let nets = this.get('network') || [];\n\n    if (!Array.isArray(nets))\n      nets = nets.split(' ');\n\n    return nets;\n  }\n\n  addNetwork(net) {\n    let nets = this.network();\n\n    if (nets.indexOf(net) > -1)\n      return;\n\n    nets.push(net);\n    this.set('network', nets.join(' '));\n  }\n\n  delNetwork(net) {\n    let nets = this.network();\n\n    if (nets.indexOf(net) < 0)\n      return;\n\n    nets.splice(nets.indexOf(net), 1);\n    this.set('network', nets.join(' '));\n  }\n\n  findForwardsBy(what) {\n    const forwards = [];\n    const name = this.name();\n\n    if (what !== 'src' && what !== 'dest')\n      return forwards;\n\n    firewall.forwards.forEach(fwd => {\n      if (fwd.src() && fwd.dest() && fwd[what]() === name)\n        forwards.push(fwd);\n    });\n\n    return forwards;\n  }\n\n  color() {\n    const name = this.name()\n    if (name === 'lan')\n      return '#90f090';\n    else if (name === 'wan')\n      return '#f09090';\n\n    const r = parseInt(Math.random() * 128) + 1;\n    const g = parseInt(Math.random() * 128) + 1;\n    let min = 0;\n    let max = 128;\n\n    if (r + g < 128)\n      min = 128 - r - g;\n    else\n      max = 255 - r - g;\n\n    const b = min + Math.floor(Math.random() * (max - min));\n\n    return '#%02x%02x%02x'.format(0xFF - r, 0xFF - g, 0xFF - b);\n  }\n}\n\nclass Forward {\n  constructor(sid) {\n    this.sid = sid;\n  }\n\n  get(key) {\n    return uci.get('firewall', this.sid, key);\n  }\n\n  set(key, val) {\n    return uci.set('firewall', this.sid, key, val);\n  }\n\n  src() {\n    return this.get('src');\n  }\n\n  dest() {\n    return this.get('dest');\n  }\n}\n\nfirewall.loadFromLocal = function() {\n  this.zones = uci.sections('firewall', 'zone').map(s => new Zone(s['.name']));\n  this.forwards = uci.sections('firewall', 'forwarding').map(s => new Forward(s['.name']));\n}\n\nfirewall.load = function(local) {\n  if (local) {\n    this.loadFromLocal();\n    return;\n  }\n\n  return new Promise(resolve => {\n    uci.load('firewall').then(() => {\n      this.loadFromLocal();\n      resolve();\n    });\n  });\n}\n\nfirewall.findZoneByNetwork = function(net) {\n  for (let i = 0; i < this.zones.length; i++) {\n    const zone = this.zones[i];\n    const nets = zone.network();\n    if (nets.indexOf(net) > -1)\n      return zone;\n  }\n  return undefined;\n}\n\nfirewall.findZoneByName = function(name) {\n  for (let i = 0; i < this.zones.length; i++) {\n    const zone = this.zones[i];\n    if (zone.name() === name)\n      return zone;\n  }\n  return undefined;\n}\n\nfirewall.findZoneBySid = function(sid) {\n  for (let i = 0; i < this.zones.length; i++) {\n    const zone = this.zones[i];\n    if (zone.sid === sid)\n      return zone;\n  }\n  return undefined;\n}\n\nfirewall.createZone = function(name) {\n  const sid = uci.add('firewall', 'zone');\n  const z = new Zone(sid);\n  this.zones.push(z);\n\n  z.set('name', name);\n  z.set('input', 'ACCEPT');\n  z.set('forward', 'REJECT');\n  z.set('output', 'ACCEPT');\n\n  return z;\n}\n\nexport default {\n  install(Vue) {\n    Vue.prototype.$firewall = firewall;\n  }\n}\n"]}]}